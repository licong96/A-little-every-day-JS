<!DOCTYPE HTML>
<html>

<head>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title></title>
	<style>
		* {
			margin: 0;
      padding: 0;
      box-sizing: border-box;
		}
		li {
			list-style: none;
		}
		img {
			border: none;
			vertical-align: top;
		}
		#box {
			width: 470px;
			height: 150px;
			position: relative;
			margin: 30px auto;
			overflow: hidden;
		}
		ul {
			width: 470px;
			position: absolute;
			left: 0;
			top: 0;
			z-index: 1;
			transition: all .3s;
		}

		ul li {
			width: 470px;
		}

		ol {
			z-index: 2;
			width: 120px;
			position: absolute;
			right: 10px;
			bottom: 10px;
		}

		ol li {
			width: 20px;
			height: 20px;
			float: left;
			margin: 0 2px;
			display: inline;
			background: #fff;
			color: #f60;
			line-height: 20px;
			text-align: center;
		}

		ol .active {
			background: #f60;
			color: #fff;
		}
	</style>
	<script src="move.js"></script>
	<script>
		window.onload = function() {
			var oBox = document.querySelector('#box')
			var oUl = document.querySelector('ul');
			var aLi = document.querySelectorAll('ul li');
			var aBtn = document.querySelectorAll('ol li');
			var oLiHeight = aLi[0].clientHeight;
			var currentIndex = 0;
			var iNow = 0;
			var iNow2 = 0;
			var time = null;

			for (let i = 0; i < aBtn.length; i++) {
					aBtn[i].onmouseover = function () {
						iNow = i
						iNow2 = i
						oUl.style.transform = `translateY(-${i * oLiHeight}px)`;
						aBtn[currentIndex].classList.remove('active');
						currentIndex = i
						this.classList.add('active');
					}
			}

			var time = setInterval(toRun, 2000);

			oBox.onmouseover = function () {
				clearInterval(time)
			}
			oBox.onmouseout = function () {
				time = setInterval(toRun, 2000)
			}

			function toRun() {
				iNow2++
				oUl.style.transition = 'all .3s'
				if (iNow === aLi.length-1) {
					iNow = 0;
					aLi[0].style.position = 'relative';
					aLi[0].style.top = oLiHeight * aLi.length + 'px'
				} else {
					iNow++
				}

				oUl.style.transform = `translateY(-${iNow2 * oLiHeight}px)`;
				
				if (iNow2 === aLi.length) {
					// 这里需要延迟
					setTimeout(() => {
						iNow2 = 0;
						oUl.style.transform = `translateY(0px)`;
						oUl.style.transition = 'none'
						aLi[0].style.position = 'static';
					}, 300)
				}
				aBtn[currentIndex].classList.remove('active');
				currentIndex = iNow
				aBtn[iNow].classList.add('active');
			}
		};
	</script>
</head>

<body>
	<div id="box">
		<ul>
			<li><img src="images/1.jpg" alt="" /></li>
			<li><img src="images/2.jpg" alt="" /></li>
			<li><img src="images/3.jpg" alt="" /></li>
			<li><img src="images/4.jpg" alt="" /></li>
			<li><img src="images/5.jpg" alt="" /></li>
		</ul>
		<ol>
			<li class="active">1</li>
			<li>2</li>
			<li>3</li>
			<li>4</li>
			<li>5</li>
		</ol>
	</div>
</body>

</html>
